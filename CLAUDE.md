# Telegram Autoposter ‚Äî –ü—Ä–æ–µ–∫—Ç–Ω–∞—è –ø–∞–º—è—Ç—å

## –û–±–∑–æ—Ä –ø—Ä–æ–µ–∫—Ç–∞
–ê–≤—Ç–æ–ø–æ—Å—Ç–µ—Ä –¥–ª—è Telegram-–∫–∞–Ω–∞–ª–∞ —ç–∫—Å–ø–µ—Ä—Ç–∞ –ø–æ –µ—Å—Ç–µ—Å—Ç–≤–µ–Ω–Ω–æ–º—É –æ–º–æ–ª–æ–∂–µ–Ω–∏—é –ª–∏—Ü–∞.
–¶–µ–ª–µ–≤–∞—è –∞—É–¥–∏—Ç–æ—Ä–∏—è: –∂–µ–Ω—â–∏–Ω—ã 30-55 –ª–µ—Ç.

**–î–≤—É—Ö—Ñ–∞–∑–Ω—ã–π –ø–∞–π–ø–ª–∞–π–Ω:**
1. **Phase 1 (05:00 –ú–°–ö / 02:00 UTC):** –ì–µ–Ω–µ—Ä–∞—Ü–∏—è —á–µ—Ä–Ω–æ–≤–∏–∫–∞ ‚Üí `pending_post.json`
2. **Phase 2 (15:00 –ú–°–ö / 12:00 UTC):** –ü—É–±–ª–∏–∫–∞—Ü–∏—è –Ω–∞ –≤—ã–±—Ä–∞–Ω–Ω—ã–µ –ø–ª–∞—Ç—Ñ–æ—Ä–º—ã

–ú–µ–∂–¥—É —Ñ–∞–∑–∞–º–∏ ‚Äî –æ–∫–Ω–æ 10 —á–∞—Å–æ–≤ –¥–ª—è —Ä—É—á–Ω–æ–≥–æ —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è —á–µ—Ä–µ–∑ Streamlit UI.

**–ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º—ã–µ –ø–ª–∞—Ç—Ñ–æ—Ä–º—ã:** Telegram, –í–ö–æ–Ω—Ç–∞–∫—Ç–µ, Max (–±—ã–≤—à. TamTam), Pinterest.

---

## –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ —Ñ–∞–π–ª–æ–≤

| –§–∞–π–ª | –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ |
|------|-----------|
| `main.py` | CLI: `generate` / `publish` / `full` |
| `app.py` | Streamlit Web UI (~1800 —Å—Ç—Ä–æ–∫) |
| `config.py` | –ó–∞–≥—Ä—É–∑–∫–∞ env-–ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö, API-–∫–ª—é—á–µ–π, —Ñ–∞–±—Ä–∏–∫–∞ `get_gemini_client()` |
| `generate_text.py` | –ì–µ–Ω–µ—Ä–∞—Ü–∏—è —Ç–µ–∫—Å—Ç–∞ (Claude/Gemini/OpenAI) |
| `generate_image.py` | –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π (Gemini/OpenAI), –ø–æ–¥–¥–µ—Ä–∂–∫–∞ inline face + reference photo |
| `image_library.py` | –ë–∏–±–ª–∏–æ—Ç–µ–∫–∞ –≥–æ—Ç–æ–≤—ã—Ö –∫–∞—Ä—Ç–∏–Ω–æ–∫ (—Ö—Ä–∞–Ω–∏–ª–∏—â–µ + circular queue) |
| `face_swap.py` | –ó–∞–º–µ–Ω–∞ –ª–∏—Ü–∞ (Replicate/Gemini/OpenAI) ‚Äî –æ—Ç–¥–µ–ª—å–Ω—ã–π —à–∞–≥ |
| `post_telegram.py` | –û—Ç–ø—Ä–∞–≤–∫–∞ –≤ Telegram |
| `post_vk.py` | –û—Ç–ø—Ä–∞–≤–∫–∞ –≤ –í–ö–æ–Ω—Ç–∞–∫—Ç–µ |
| `post_max.py` | –û—Ç–ø—Ä–∞–≤–∫–∞ –≤ Max (–±—ã–≤—à. TamTam) |
| `post_pinterest.py` | –û—Ç–ø—Ä–∞–≤–∫–∞ –≤ Pinterest |
| `utils.py` | –û–±—â–∏–µ —É—Ç–∏–ª–∏—Ç—ã: `strip_html`, `image_to_base64`, `base64_to_tempfile`, `detect_content_type`, `retry` |
| `document_parser.py` | –ü–∞—Ä—Å–∏–Ω–≥ PDF/DOCX/TXT –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤ |

**–î–∞–Ω–Ω—ã–µ (JSON):**
- `ideas.json` ‚Äî –ø—É–ª –∏–¥–µ–π –¥–ª—è –ø–æ—Å—Ç–æ–≤ (`used: true/false`)
- `pending_post.json` ‚Äî —Ç–µ–∫—É—â–∏–π —á–µ—Ä–Ω–æ–≤–∏–∫ (—Ç–µ–∫—Å—Ç + base64 –∫–∞—Ä—Ç–∏–Ω–∫–∞)
- `history.json` ‚Äî –∞—Ä—Ö–∏–≤ –æ–ø—É–±–ª–∏–∫–æ–≤–∞–Ω–Ω—ã—Ö –ø–æ—Å—Ç–æ–≤
- `prompts.json` ‚Äî –∫–∞—Å—Ç–æ–º–Ω—ã–µ –ø—Ä–æ–º–ø—Ç—ã (system + image)
- `expert_face.json` ‚Äî base64 —Ñ–æ—Ç–æ —ç–∫—Å–ø–µ—Ä—Ç–∞ –¥–ª—è face swap
- `prompt_context.json` ‚Äî –∫–æ–Ω—Ç–µ–∫—Å—Ç–Ω—ã–π –¥–æ–∫—É–º–µ–Ω—Ç (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
- `image_library.json` ‚Äî –∏–Ω–¥–µ–∫—Å –±–∏–±–ª–∏–æ—Ç–µ–∫–∏ –∫–∞—Ä—Ç–∏–Ω–æ–∫ (–º–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ + `next_index`)
- `image_library/N.json` ‚Äî –æ—Ç–¥–µ–ª—å–Ω—ã–µ —Ñ–∞–π–ª—ã –∫–∞—Ä—Ç–∏–Ω–æ–∫ (base64 JPEG)

**–ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è:**
- `provider.cfg` ‚Äî –≤—ã–±–æ—Ä –ø—Ä–æ–≤–∞–π–¥–µ—Ä–æ–≤ + —Ñ–ª–∞–≥ –∞–≤—Ç–æ–ø—É–±–ª–∏–∫–∞—Ü–∏–∏ + –∏—Å—Ç–æ—á–Ω–∏–∫ –∫–∞—Ä—Ç–∏–Ω–æ–∫ + –ø–ª–∞—Ç—Ñ–æ—Ä–º—ã –ø—É–±–ª–∏–∫–∞—Ü–∏–∏
- `.github/workflows/autopublish.yml` ‚Äî GitHub Actions

---

## –ü—Ä–æ–≤–∞–π–¥–µ—Ä—ã

### –¢–µ–∫—Å—Ç
| –ü—Ä–æ–≤–∞–π–¥–µ—Ä | –ú–æ–¥–µ–ª—å | –°—Ç–∞—Ç—É—Å |
|-----------|--------|--------|
| `openai` | gpt-4o | –†–∞–±–æ—Ç–∞–µ—Ç |
| `claude` | claude-sonnet-4-5-20250929 | –†–∞–±–æ—Ç–∞–µ—Ç |
| `gemini` | gemini-2.5-flash | –†–∞–±–æ—Ç–∞–µ—Ç |

### –ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è
| –ü—Ä–æ–≤–∞–π–¥–µ—Ä | –ú–æ–¥–µ–ª—å (–±–µ–∑ face) | –ú–æ–¥–µ–ª—å (—Å inline face) | –°—Ç–∞—Ç—É—Å |
|-----------|-------------------|------------------------|--------|
| `openai` | dall-e-3 (1024x1024) | gpt-image-1 via `images.edit()` | –†–∞–±–æ—Ç–∞–µ—Ç |
| `gemini` | gemini-2.5-flash-image | gemini-2.5-flash-image (multimodal) | –†–∞–±–æ—Ç–∞–µ—Ç (–Ω—É–∂–µ–Ω –±–∏–ª–ª–∏–Ω–≥) |
| `library` | –ì–æ—Ç–æ–≤—ã–µ –∫–∞—Ä—Ç–∏–Ω–∫–∏ –∏–∑ –±–∏–±–ª–∏–æ—Ç–µ–∫–∏ | ‚Äî | –†–∞–±–æ—Ç–∞–µ—Ç |

### Face Swap (–æ—Ç–¥–µ–ª—å–Ω—ã–π —à–∞–≥)
| –ü—Ä–æ–≤–∞–π–¥–µ—Ä | –ú–æ–¥–µ–ª—å | –°—Ç–∞—Ç—É—Å |
|-----------|--------|--------|
| `replicate` | codeplugtech/face-swap:278a81e7... | –†–∞–±–æ—Ç–∞–µ—Ç (–ø–ª–∞—Ç–Ω–æ ~$0.01) |
| `gemini` | gemini-2.5-flash-image | –†–∞–±–æ—Ç–∞–µ—Ç (–Ω—É–∂–µ–Ω –±–∏–ª–ª–∏–Ω–≥) |
| `openai` | gpt-image-1 via `images.edit()` | –†–∞–±–æ—Ç–∞–µ—Ç |

---

## –ë–∏–±–ª–∏–æ—Ç–µ–∫–∞ –∫–∞—Ä—Ç–∏–Ω–æ–∫ (—Ñ–∏—á–∞, —Ñ–µ–≤—Ä–∞–ª—å 2026)

–ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–∞ AI-–≥–µ–Ω–µ—Ä–∞—Ü–∏–∏: –∑–∞—Ä–∞–Ω–µ–µ –∑–∞–≥—Ä—É–∂–µ–Ω–Ω—ã–µ –∫–∞—Ä—Ç–∏–Ω–∫–∏ –≤—ã–¥–∞—é—Ç—Å—è –ø–æ –æ—á–µ—Ä–µ–¥–∏ (circular queue).

### –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ —Ö—Ä–∞–Ω–µ–Ω–∏—è
**Split storage** ‚Äî –∏–Ω–¥–µ–∫—Å –∏ –∫–∞—Ä—Ç–∏–Ω–∫–∏ —Ö—Ä–∞–Ω—è—Ç—Å—è —Ä–∞–∑–¥–µ–ª—å–Ω–æ:
- `image_library.json` ‚Äî –ª—ë–≥–∫–∏–π –∏–Ω–¥–µ–∫—Å: `{"images": [{index, filename}, ...], "next_index": 0}`
- `image_library/N.json` ‚Äî –∫–∞–∂–¥–∞—è –∫–∞—Ä—Ç–∏–Ω–∫–∞ –≤ –æ—Ç–¥–µ–ª—å–Ω–æ–º —Ñ–∞–π–ª–µ (base64 JPEG)

**–ü—Ä–∏—á–∏–Ω–∞:** GitHub –∏–º–µ–µ—Ç –ª–∏–º–∏—Ç 100MB –Ω–∞ —Ñ–∞–π–ª. –ü—Ä–∏ —Ö—Ä–∞–Ω–µ–Ω–∏–∏ –≤—Å–µ—Ö –∫–∞—Ä—Ç–∏–Ω–æ–∫ –≤ –æ–¥–Ω–æ–º JSON –ª–∏–º–∏—Ç –±—ã –¥–æ—Å—Ç–∏–≥–∞–ª—Å—è –ø—Ä–∏ ~700-1000 –∫–∞—Ä—Ç–∏–Ω–∫–∞—Ö.

### Circular Queue
- `next_index` ‚Äî —É–∫–∞–∑–∞—Ç–µ–ª—å –Ω–∞ —Å–ª–µ–¥—É—é—â—É—é –∫–∞—Ä—Ç–∏–Ω–∫—É
- –ü—Ä–∏ –≤—ã–¥–∞—á–µ: –±–µ—Ä—ë—Ç—Å—è –∫–∞—Ä—Ç–∏–Ω–∫–∞ –ø–æ `next_index`, –∑–∞—Ç–µ–º —É–∫–∞–∑–∞—Ç–µ–ª—å —Å–¥–≤–∏–≥–∞–µ—Ç—Å—è –Ω–∞ +1
- –ü—Ä–∏ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–∏ –∫–æ–Ω—Ü–∞ ‚Äî `next_index` —Å–±—Ä–∞—Å—ã–≤–∞–µ—Ç—Å—è –Ω–∞ 0 (–Ω–∞—á–∏–Ω–∞–µ—Ç —Å–Ω–∞—á–∞–ª–∞)
- –ö–Ω–æ–ø–∫–∞ "–°–±—Ä–æ—Å–∏—Ç—å —Å—á—ë—Ç—á–∏–∫" –≤ UI –ø–æ–∑–≤–æ–ª—è–µ—Ç –≤—Ä—É—á–Ω—É—é –Ω–∞—á–∞—Ç—å —Å –ø–µ—Ä–≤–æ–π –∫–∞—Ä—Ç–∏–Ω–∫–∏

### –ü–µ—Ä–µ–∫–ª—é—á–∞—Ç–µ–ª—å IMAGE_SOURCE
–ù–∞—Å—Ç—Ä–æ–π–∫–∞ `IMAGE_SOURCE` –≤ `provider.cfg` –∏ sidebar UI:
- `generate` ‚Äî AI-–≥–µ–Ω–µ—Ä–∞—Ü–∏—è –∫–∞—Ä—Ç–∏–Ω–æ–∫ (—Ç–µ–∫—É—â–µ–µ –ø–æ–≤–µ–¥–µ–Ω–∏–µ, –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é)
- `library` ‚Äî –≥–æ—Ç–æ–≤—ã–µ –∫–∞—Ä—Ç–∏–Ω–∫–∏ –∏–∑ –±–∏–±–ª–∏–æ—Ç–µ–∫–∏

–ü—Ä–∏ `IMAGE_SOURCE=library`:
- –°–∫—Ä—ã–≤–∞—é—Ç—Å—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ IMAGE_PROVIDER –∏ FACE_SWAP_PROVIDER –≤ sidebar
- –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –∫–∞—Ä—Ç–∏–Ω–∫–∏ –∑–∞–º–µ–Ω—è–µ—Ç—Å—è –Ω–∞ –≤—ã–±–æ—Ä–∫—É –∏–∑ –±–∏–±–ª–∏–æ—Ç–µ–∫–∏
- Face swap –Ω–µ –ø—Ä–∏–º–µ–Ω—è–µ—Ç—Å—è

### –†–µ–∞–ª–∏–∑–∞—Ü–∏—è –≤ image_library.py
```python
load_index() / save_index()        # –ß—Ç–µ–Ω–∏–µ/–∑–∞–ø–∏—Å—å image_library.json
load_image_b64(index)              # –ó–∞–≥—Ä—É–∑–∫–∞ base64 –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–π –∫–∞—Ä—Ç–∏–Ω–∫–∏
add_image(image_bytes, filename)   # –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –Ω–æ–≤–æ–π –∫–∞—Ä—Ç–∏–Ω–∫–∏ (–≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç index)
remove_image(idx)                  # –£–¥–∞–ª–µ–Ω–∏–µ (–∫–æ—Ä—Ä–µ–∫—Ç–∏—Ä—É–µ—Ç next_index)
get_next_image()                   # –°–ª–µ–¥—É—é—â–∞—è –∫–∞—Ä—Ç–∏–Ω–∫–∞ (–ù–ï —Å–¥–≤–∏–≥–∞–µ—Ç —É–∫–∞–∑–∞—Ç–µ–ª—å)
advance_pointer()                  # –°–¥–≤–∏–≥ next_index –Ω–∞ +1 (—Å wrap-around)
reset_pointer()                    # –°–±—Ä–æ—Å next_index –Ω–∞ 0
count()                            # –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –∫–∞—Ä—Ç–∏–Ω–æ–∫
get_all_thumbnails()               # –í—Å–µ –∫–∞—Ä—Ç–∏–Ω–∫–∏ –¥–ª—è –≥–∞–ª–µ—Ä–µ–∏
```

### Persistence –Ω–∞ Streamlit Cloud
Streamlit Cloud –∏—Å–ø–æ–ª—å–∑—É–µ—Ç —ç—Ñ–µ–º–µ—Ä–Ω—É—é —Ñ–∞–π–ª–æ–≤—É—é —Å–∏—Å—Ç–µ–º—É ‚Äî –ª–æ–∫–∞–ª—å–Ω—ã–µ —Ñ–∞–π–ª—ã —Ç–µ—Ä—è—é—Ç—Å—è –ø—Ä–∏ –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–µ.

**–†–µ—à–µ–Ω–∏–µ:** –§—É–Ω–∫—Ü–∏—è `_ensure_image_library_from_github()` –≤ `app.py`:
1. –í—ã–∑—ã–≤–∞–µ—Ç—Å—è –ø—Ä–∏ —Å—Ç–∞—Ä—Ç–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è (–ø–æ—Å–ª–µ `st.set_page_config`)
2. –ü—Ä–æ–≤–µ—Ä—è–µ—Ç, –µ—Å—Ç—å –ª–∏ `image_library.json` –ª–æ–∫–∞–ª—å–Ω–æ
3. –ï—Å–ª–∏ –Ω–µ—Ç ‚Äî –∑–∞–≥—Ä—É–∂–∞–µ—Ç –∏–Ω–¥–µ–∫—Å –∏ –≤—Å–µ —Ñ–∞–π–ª—ã –∫–∞—Ä—Ç–∏–Ω–æ–∫ –∏–∑ GitHub
4. –ö—ç—à–∏—Ä—É–µ—Ç –ª–æ–∫–∞–ª—å–Ω–æ –¥–ª—è –ø–æ—Å–ª–µ–¥—É—é—â–∏—Ö –∑–∞–ø—Ä–æ—Å–æ–≤

**–°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è –≤ GitHub:** –ü—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ/—É–¥–∞–ª–µ–Ω–∏–∏ –∫–∞—Ä—Ç–∏–Ω–æ–∫ —á–µ—Ä–µ–∑ UI:
- `sync_library_image_to_github()` ‚Äî –∑–∞–≥—Ä—É–∑–∫–∞/–æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –æ—Ç–¥–µ–ª—å–Ω–æ–π –∫–∞—Ä—Ç–∏–Ω–∫–∏
- `sync_image_library_index_to_github()` ‚Äî –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∏–Ω–¥–µ–∫—Å–∞
- `delete_library_image_from_github()` ‚Äî —É–¥–∞–ª–µ–Ω–∏–µ —Ñ–∞–π–ª–∞ –∫–∞—Ä—Ç–∏–Ω–∫–∏
- –¢—Ä–µ–±—É–µ—Ç—Å—è `GITHUB_TOKEN` ‚Äî –±–µ–∑ –Ω–µ–≥–æ –∫–∞—Ä—Ç–∏–Ω–∫–∏ –Ω–µ –ø–µ—Ä–µ–∂–∏–≤—É—Ç –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫—É

### –í–∫–ª–∞–¥–∫–∞ "–ë–∏–±–ª–∏–æ—Ç–µ–∫–∞" –≤ Streamlit UI (6-—è –≤–∫–ª–∞–¥–∫–∞)
- –°—Ç–∞—Ç—É—Å-–±–∞—Ä: –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∫–∞—Ä—Ç–∏–Ω–æ–∫, —Å–ª–µ–¥—É—é—â–∞—è –≤ –æ—á–µ—Ä–µ–¥–∏
- –ó–∞–≥—Ä—É–∑—á–∏–∫: multiple —Ñ–∞–π–ª–æ–≤ (jpg/jpeg/png), –∫–Ω–æ–ø–∫–∞ "–î–æ–±–∞–≤–∏—Ç—å –≤ –±–∏–±–ª–∏–æ—Ç–µ–∫—É"
- –ì–∞–ª–µ—Ä–µ—è: —Å–µ—Ç–∫–∞ 4 –∫–æ–ª–æ–Ω–∫–∏, —Å –ø—Ä–µ–≤—å—é, –ø–æ–¥–ø–∏—Å—è–º–∏, –∫–Ω–æ–ø–∫–∞–º–∏ —É–¥–∞–ª–µ–Ω–∏—è
- –¢–µ–∫—É—â–∞—è (—Å–ª–µ–¥—É—é—â–∞—è) –∫–∞—Ä—Ç–∏–Ω–∫–∞ –æ—Ç–º–µ—á–µ–Ω–∞ –º–∞—Ä–∫–µ—Ä–æ–º ‚ñ∂
- –ö–Ω–æ–ø–∫–∞ "–°–±—Ä–æ—Å–∏—Ç—å —Å—á—ë—Ç—á–∏–∫ –Ω–∞ –Ω–∞—á–∞–ª–æ"

### –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è –≤ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ –≤–∫–ª–∞–¥–∫–∏
- **"–°–æ–∑–¥–∞—Ç—å –ø–æ—Å—Ç":** –ø—Ä–∏ `IMAGE_SOURCE=library` ‚Äî –±–µ—Ä—ë—Ç –∫–∞—Ä—Ç–∏–Ω–∫—É –∏–∑ –±–∏–±–ª–∏–æ—Ç–µ–∫–∏ –≤–º–µ—Å—Ç–æ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏, –∫–Ω–æ–ø–∫–∞ –ø–µ—Ä–µ–≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ ‚Üí "–°–ª–µ–¥—É—é—â–∞—è –∏–∑ –±–∏–±–ª–∏–æ—Ç–µ–∫–∏"
- **"–ê–≤—Ç–æ–ø—É–±–ª–∏–∫–∞—Ü–∏—è":** –∞–Ω–∞–ª–æ–≥–∏—á–Ω–æ–µ –≤–µ—Ç–≤–ª–µ–Ω–∏–µ –ø—Ä–∏ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ —á–µ—Ä–Ω–æ–≤–∏–∫–∞ –∏ –ø–µ—Ä–µ–≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –∫–∞—Ä—Ç–∏–Ω–∫–∏
- **main.py:** `cmd_generate()` –∏ `cmd_full()` ‚Äî –≤–µ—Ç–≤–ª–µ–Ω–∏–µ –ø–æ `IMAGE_SOURCE`
- **autopublish.yml:** —á–∏—Ç–∞–µ—Ç `IMAGE_SOURCE` –∏–∑ `provider.cfg`, –ø–µ—Ä–µ–¥–∞—ë—Ç –∫–∞–∫ env

---

## –ú—É–ª—å—Ç–∏–ø–ª–∞—Ç—Ñ–æ—Ä–º–µ–Ω–Ω–∞—è –ø—É–±–ª–∏–∫–∞—Ü–∏—è (—Ñ–∏—á–∞, –º–∞—Ä—Ç 2026)

–ü–æ—Å—Ç—ã –ø—É–±–ª–∏–∫—É—é—Ç—Å—è –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ –Ω–∞ –Ω–µ—Å–∫–æ–ª—å–∫–æ –ø–ª–∞—Ç—Ñ–æ—Ä–º. –ö–∞–∂–¥–∞—è –ø–ª–∞—Ç—Ñ–æ—Ä–º–∞ –ø—É–±–ª–∏–∫—É–µ—Ç—Å—è –Ω–µ–∑–∞–≤–∏—Å–∏–º–æ ‚Äî –æ—à–∏–±–∫–∞ –Ω–∞ –æ–¥–Ω–æ–π –Ω–µ –±–ª–æ–∫–∏—Ä—É–µ—Ç –¥—Ä—É–≥–∏–µ.

### –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º—ã–µ –ø–ª–∞—Ç—Ñ–æ—Ä–º—ã

| –ü–ª–∞—Ç—Ñ–æ—Ä–º–∞ | –ú–æ–¥—É–ª—å | API | –°—Ç–∞—Ç—É—Å |
|-----------|--------|-----|--------|
| Telegram | `post_telegram.py` | Bot API (`sendPhoto`) | –†–∞–±–æ—Ç–∞–µ—Ç |
| –í–ö–æ–Ω—Ç–∞–∫—Ç–µ | `post_vk.py` | VK API v5.199 (`wall.post` + `photos.upload`) | –†–∞–±–æ—Ç–∞–µ—Ç |
| Max | `post_max.py` | Max Bot API (`platform-api.max.ru`) | –†–∞–±–æ—Ç–∞–µ—Ç |
| Pinterest | `post_pinterest.py` | Pinterest API v5 (`/v5/pins`) | –†–∞–±–æ—Ç–∞–µ—Ç |

### –ù–∞—Å—Ç—Ä–æ–π–∫–∞ PUBLISH_TARGETS
–í `provider.cfg` –∏ sidebar UI ‚Äî —Å–ø–∏—Å–æ–∫ –ø–ª–∞—Ç—Ñ–æ—Ä–º —á–µ—Ä–µ–∑ –∑–∞–ø—è—Ç—É—é:
```
PUBLISH_TARGETS=telegram,vk,max,pinterest
```
–ü–æ —É–º–æ–ª—á–∞–Ω–∏—é: `telegram` (—Ç–æ–ª—å–∫–æ Telegram).

### –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –ø—É–±–ª–∏–∫–∞—Ü–∏–∏

**`main.py` ‚Äî `publish_to_all()`:**
```python
def publish_to_all(image_path: str, caption: str) -> dict:
    targets = [t.strip() for t in PUBLISH_TARGETS.split(",")]
    platform_ids = {}
    for target in targets:
        # –ò–º–ø–æ—Ä—Ç–∏—Ä—É–µ—Ç –∏ –≤—ã–∑—ã–≤–∞–µ—Ç send_post –¥–ª—è –∫–∞–∂–¥–æ–π –ø–ª–∞—Ç—Ñ–æ—Ä–º—ã
        # –û—à–∏–±–∫–∏ –ª–æ–≥–∏—Ä—É—é—Ç—Å—è, –Ω–æ –Ω–µ –æ—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞—é—Ç –ø—Ä–æ—Ü–µ—Å—Å
    return platform_ids  # {"telegram": 123, "vk": "wall-123_456", ...}
```

**`app.py` ‚Äî `_publish_to_platforms()`:**
```python
def _publish_to_platforms(photo_path, caption, targets, env) -> dict:
    # –ê–Ω–∞–ª–æ–≥–∏—á–Ω–∞—è –ª–æ–≥–∏–∫–∞ –¥–ª—è Streamlit UI
    # –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç {platform: {"ok": bool, "message_id": ..., "error": ...}}
```

### –û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏ API –ø–æ –ø–ª–∞—Ç—Ñ–æ—Ä–º–∞–º

**VK API:**
- –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç **–æ–±–∞ —Ç–∏–ø–∞ —Ç–æ–∫–µ–Ω–æ–≤**: –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–π –∏ community (group)
- User token: `getWallUploadServer` ‚Üí upload ‚Üí `saveWallPhoto` ‚Üí `wall.post`
- Group token: `getMessagesUploadServer` ‚Üí upload ‚Üí `saveMessagesPhoto` ‚Üí `wall.post`
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π fallback: –µ—Å–ª–∏ `getWallUploadServer` –≤–µ—Ä–Ω—ë—Ç "group authorization failed", –ø–µ—Ä–µ–∫–ª—é—á–∞–µ—Ç—Å—è –Ω–∞ Messages Upload
- `owner_id` = –æ—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω—ã–π `VK_GROUP_ID` (–¥–ª—è –ø—É–±–ª–∏–∫–∞—Ü–∏–∏ –≤ –≥—Ä—É–ø–ø—É)
- –¢–µ–∫—Å—Ç ‚Äî plain text (HTML-—Ç–µ–≥–∏ —É–¥–∞–ª—è—é—Ç—Å—è)

**Max Bot API:**
- Base URL: `https://platform-api.max.ru`
- –¢–æ–∫–µ–Ω –ø–µ—Ä–µ–¥–∞—ë—Ç—Å—è –≤ `Authorization: Bearer <token>`
- 2-—à–∞–≥–æ–≤—ã–π –ø—Ä–æ—Ü–µ—Å—Å: POST `/uploads` (multipart image) ‚Üí POST `/messages` —Å attachment
- Max ‚Äî —Ä–µ–±—Ä–µ–Ω–¥–∏–Ω–≥ TamTam, API –º–∏–≥—Ä–∏—Ä–æ–≤–∞–Ω–æ —Å `botapi.tamtam.chat` –Ω–∞ `platform-api.max.ru`

**Pinterest API v5:**
- POST `/v5/pins` —Å `media_source.type=image_base64`
- OAuth2 Bearer token
- –ü–µ—Ä–≤–∞—è —Å—Ç—Ä–æ–∫–∞ —Ç–µ–∫—Å—Ç–∞ ‚Üí `title` (–º–∞–∫—Å. 100 —Å–∏–º–≤–æ–ª–æ–≤), –æ—Å—Ç–∞–ª—å–Ω–æ–µ ‚Üí `description` (–º–∞–∫—Å. 500)
- –ù—É–∂–µ–Ω `board_id` (ID –¥–æ—Å–∫–∏)

**Telegram Bot API:**
- Caption ‚â§ 1024 —Å–∏–º–≤–æ–ª–æ–≤ ‚Üí –µ—Å–ª–∏ –¥–ª–∏–Ω–Ω–µ–µ, —Ñ–æ—Ç–æ + –æ—Ç–¥–µ–ª—å–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ
- HTML-—Ä–∞–∑–º–µ—Ç–∫–∞ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç—Å—è (`parse_mode=HTML`)

### HTML ‚Üí Plain Text
VK, Max –∏ Pinterest –Ω–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞—é—Ç HTML-—Ä–∞–∑–º–µ—Ç–∫—É. –í—Å–µ —Ç—Ä–∏ –º–æ–¥—É–ª—è –∏—Å–ø–æ–ª—å–∑—É—é—Ç `strip_html()` –∏–∑ `utils.py`:
```python
from utils import strip_html
plain_text = strip_html(caption)  # <br> ‚Üí \n, —É–¥–∞–ª—è–µ—Ç —Ç–µ–≥–∏, –¥–µ–∫–æ–¥–∏—Ä—É–µ—Ç HTML-entities
```

### –ò—Å—Ç–æ—Ä–∏—è –∏ platform_ids
`history.json` –∏ `pending_post.json` —Ö—Ä–∞–Ω—è—Ç `platform_ids` ‚Äî —Å–ª–æ–≤–∞—Ä—å ID –ø—É–±–ª–∏–∫–∞—Ü–∏–π –ø–æ –ø–ª–∞—Ç—Ñ–æ—Ä–º–∞–º:
```json
{
  "message_id": 12345,
  "platform_ids": {
    "telegram": 12345,
    "vk": "wall-123456_789",
    "max": "mid.abc123",
    "pinterest": "pin_123456"
  }
}
```
–ü–æ–ª–µ `message_id` —Å–æ—Ö—Ä–∞–Ω–µ–Ω–æ –¥–ª—è –æ–±—Ä–∞—Ç–Ω–æ–π —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç–∏ (= Telegram ID –∏–ª–∏ –ø–µ—Ä–≤—ã–π –¥–æ—Å—Ç—É–ø–Ω—ã–π).

### –ü–ª–∞—Ç—Ñ–æ—Ä–º–µ–Ω–Ω—ã–µ —Ñ—É—Ç–µ—Ä—ã (—Ñ–∏—á–∞, –º–∞—Ä—Ç 2026)

–ß–µ—Ä–Ω–æ–≤–∏–∫ (draft) —Ö—Ä–∞–Ω–∏—Ç—Å—è **–±–µ–∑** —Å—Å—ã–ª–æ–∫/—Ñ—É—Ç–µ—Ä–æ–≤ ‚Äî —Ç–µ–∫—Å—Ç —É–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω—ã–π. –ü—Ä–∏ –ø—É–±–ª–∏–∫–∞—Ü–∏–∏ –∫–∞–∂–¥–∞—è –ø–ª–∞—Ç—Ñ–æ—Ä–º–∞ –¥–æ–±–∞–≤–ª—è–µ—Ç —Å–≤–æ–π —Ñ—É—Ç–µ—Ä –∫ —Ç–µ–∫—Å—Ç—É.

| –ü–µ—Ä–µ–º–µ–Ω–Ω–∞—è | –ü–ª–∞—Ç—Ñ–æ—Ä–º–∞ | –ß—Ç–æ –¥–µ–ª–∞–µ—Ç |
|-----------|-----------|-----------|
| `TELEGRAM_FOOTER` | Telegram | –¢–µ–∫—Å—Ç –≤ –∫–æ–Ω—Ü–µ –ø–æ—Å—Ç–∞ (–ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç HTML) |
| `VK_FOOTER` | –í–ö–æ–Ω—Ç–∞–∫—Ç–µ | –¢–µ–∫—Å—Ç –≤ –∫–æ–Ω—Ü–µ –ø–æ—Å—Ç–∞ (plain text, URL –∞–≤—Ç–æ–ª–∏–Ω–∫—É–µ—Ç—Å—è) |
| `MAX_FOOTER` | Max | –¢–µ–∫—Å—Ç –≤ –∫–æ–Ω—Ü–µ –ø–æ—Å—Ç–∞ (plain text) |
| `PINTEREST_LINK` | Pinterest | URL –¥–ª—è –∫–Ω–æ–ø–∫–∏ ¬´Visit site¬ª (–ø–æ–ª–µ `link` API) |

**–í–∞–∂–Ω–æ –ø—Ä–æ Pinterest:** –°—Å—ã–ª–∫–∏ –≤ –ø–æ–ª–µ `description` –ø–∏–Ω–∞ **–Ω–µ –∫–ª–∏–∫–∞–±–µ–ª—å–Ω—ã**. Pinterest API v5 –∏–º–µ–µ—Ç –æ—Ç–¥–µ–ª—å–Ω–æ–µ –ø–æ–ª–µ `link`, –∫–æ—Ç–æ—Ä–æ–µ –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç—Å—è –∫–∞–∫ –∫–Ω–æ–ø–∫–∞ "Visit site". –ü–æ—ç—Ç–æ–º—É –¥–ª—è Pinterest –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è `PINTEREST_LINK` (URL), –∞ –Ω–µ —Ç–µ–∫—Å—Ç–æ–≤—ã–π —Ñ—É—Ç–µ—Ä.

**–†–µ–∞–ª–∏–∑–∞—Ü–∏—è:** –ö–∞–∂–¥—ã–π –º–æ–¥—É–ª—å `post_*.py` —á–∏—Ç–∞–µ—Ç —Å–≤–æ–π —Ñ—É—Ç–µ—Ä –∏–∑ `config.py` –∏ –¥–æ–±–∞–≤–ª—è–µ—Ç `\n\n` + —Ñ—É—Ç–µ—Ä –∫ —Ç–µ–∫—Å—Ç—É –ø—Ä–∏ –ø—É–±–ª–∏–∫–∞—Ü–∏–∏. –§—É—Ç–µ—Ä—ã –Ω–∞—Å—Ç—Ä–∞–∏–≤–∞—é—Ç—Å—è –≤ sidebar UI –∏ —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –≤ `provider.cfg` + `.env`.

**–ü–∞—Ä–∞–º–µ—Ç—Ä `footer_text`:** –í—Å–µ `send_post()` –ø—Ä–∏–Ω–∏–º–∞—é—Ç –æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–π `footer_text` (–∏–ª–∏ `link` –¥–ª—è Pinterest) –¥–ª—è –ø–µ—Ä–µ–æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è config-–∑–Ω–∞—á–µ–Ω–∏—è. –ï—Å–ª–∏ `None` ‚Äî –±–µ—Ä—ë—Ç—Å—è –∏–∑ config, –µ—Å–ª–∏ –ø—É—Å—Ç–∞—è —Å—Ç—Ä–æ–∫–∞ ‚Äî —Ñ—É—Ç–µ—Ä –Ω–µ –¥–æ–±–∞–≤–ª—è–µ—Ç—Å—è.

### UI: –≤—ã–±–æ—Ä –ø–ª–∞—Ç—Ñ–æ—Ä–º
–í sidebar ‚Äî –º—É–ª—å—Ç–∏—Å–µ–ª–µ–∫—Ç –¥–ª—è –≤—ã–±–æ—Ä–∞ –ø–ª–∞—Ç—Ñ–æ—Ä–º –ø—É–±–ª–∏–∫–∞—Ü–∏–∏:
- –ü—Ä–∏ –≤—ã–±–æ—Ä–µ VK ‚Üí –ø–æ—è–≤–ª—è—é—Ç—Å—è –ø–æ–ª—è VK_ACCESS_TOKEN + VK_GROUP_ID + VK_FOOTER
- –ü—Ä–∏ –≤—ã–±–æ—Ä–µ Max ‚Üí MAX_BOT_TOKEN + MAX_CHAT_ID + MAX_FOOTER
- –ü—Ä–∏ –≤—ã–±–æ—Ä–µ Pinterest ‚Üí PINTEREST_ACCESS_TOKEN + PINTEREST_BOARD_ID + PINTEREST_LINK
- Telegram ‚Äî –≤—Å–µ–≥–¥–∞ –¥–æ—Å—Ç—É–ø–µ–Ω (—Ç–æ–∫–µ–Ω + channel ID + TELEGRAM_FOOTER)

–ù–∞—Å—Ç—Ä–æ–π–∫–∏ —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –≤ `provider.cfg` (–ª–æ–∫–∞–ª—å–Ω–æ + GitHub) –ø—Ä–∏ –Ω–∞–∂–∞—Ç–∏–∏ "–°–æ—Ö—Ä–∞–Ω–∏—Ç—å".

---

## Inline Face Generation (–∫–ª—é—á–µ–≤–∞—è —Ñ–∏—á–∞, —Ñ–µ–≤—Ä–∞–ª—å 2026)

–í–º–µ—Å—Ç–æ –¥–≤—É—Ö API-–≤—ã–∑–æ–≤–æ–≤ (–≥–µ–Ω–µ—Ä–∞—Ü–∏—è + face swap) ‚Äî **–æ–¥–∏–Ω –≤—ã–∑–æ–≤** —Å –ª–∏—Ü–æ–º —ç–∫—Å–ø–µ—Ä—Ç–∞ –∫–∞–∫ —Ä–µ—Ñ–µ—Ä–µ–Ω—Å–æ–º.

### –ö–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç
```
–ï—Å–ª–∏ FACE_SWAP_PROVIDER == gemini AND IMAGE_PROVIDER == gemini:
  ‚Üí Inline: generate_image(expert_face_b64=...) ‚Äî 1 –≤—ã–∑–æ–≤
–ï—Å–ª–∏ FACE_SWAP_PROVIDER in (replicate, openai):
  ‚Üí –†–∞–∑–¥–µ–ª—å–Ω–æ: generate_image() + apply_face_swap() ‚Äî 2 –≤—ã–∑–æ–≤–∞
```

### –†–µ–∞–ª–∏–∑–∞—Ü–∏—è –ø–æ –ø—Ä–æ–≤–∞–π–¥–µ—Ä–∞–º

**Gemini inline:**
```python
# generate_image.py ‚Üí _generate_gemini()
contents = [
    prompt + "\n\n–°–æ–∑–¥–∞–π –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ, –≥–¥–µ –≥–ª–∞–≤–Ω—ã–π –ø–µ—Ä—Å–æ–Ω–∞–∂ –∏–º–µ–µ—Ç –ª–∏—Ü–æ "
             "—Å –ø—Ä–∏–ª–æ–∂–µ–Ω–Ω–æ–≥–æ —Ä–µ—Ñ–µ—Ä–µ–Ω—Å–Ω–æ–≥–æ —Ñ–æ—Ç–æ...",
    types.Part.from_bytes(data=face_bytes, mime_type="image/jpeg"),
]
response = client.models.generate_content(
    model="gemini-2.5-flash-image", contents=contents,
    config=types.GenerateContentConfig(response_modalities=["IMAGE"]),
)
```

**OpenAI** ‚Äî inline face –ù–ï –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è. OpenAI face swap —Ä–∞–±–æ—Ç–∞–µ—Ç –∫–∞–∫ **–æ—Ç–¥–µ–ª—å–Ω—ã–π —à–∞–≥** —á–µ—Ä–µ–∑ `apply_face_swap()` (–∞–Ω–∞–ª–æ–≥–∏—á–Ω–æ Replicate).

### –ì–¥–µ –≤—ã–∑—ã–≤–∞–µ—Ç—Å—è inline face
–õ–æ–≥–∏–∫–∞ inline face —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–∞ –≤ **4 –º–µ—Å—Ç–∞—Ö** `app.py` + **2 –º–µ—Å—Ç–∞** `main.py`:
```python
inline_face = (
    face_swap_prov == "gemini"
    and img_prov == "gemini"
    and expert_b64_for_swap
)
```

---

## –†–µ—Ñ–µ—Ä–µ–Ω—Å–Ω–æ–µ —Ñ–æ—Ç–æ –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –∫–∞—Ä—Ç–∏–Ω–æ–∫ (—Ñ–µ–≤—Ä–∞–ª—å 2026)

–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –º–æ–∂–µ—Ç –∑–∞–≥—Ä—É–∑–∏—Ç—å —Ñ–æ—Ç–æ-—Ä–µ—Ñ–µ—Ä–µ–Ω—Å, –∫–æ—Ç–æ—Ä–æ–µ AI –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –∫–∞–∫ –æ—Ä–∏–µ–Ω—Ç–∏—Ä –¥–ª—è —Å—Ç–∏–ª—è, –∫–æ–º–ø–æ–∑–∏—Ü–∏–∏ –∏ –∞—Ç–º–æ—Å—Ñ–µ—Ä—ã –ø—Ä–∏ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –∫–∞—Ä—Ç–∏–Ω–æ–∫.

### –ì–¥–µ –¥–æ—Å—Ç—É–ø–Ω–æ –≤ UI
–ó–∞–≥—Ä—É–∑—á–∏–∫ —Ä–µ—Ñ–µ—Ä–µ–Ω—Å–Ω–æ–≥–æ —Ñ–æ—Ç–æ –µ—Å—Ç—å –≤ **3 –≤–∫–ª–∞–¥–∫–∞—Ö** Streamlit:
1. **–ü—Ä–æ–º–ø—Ç—ã** ‚Äî —Å–µ–∫—Ü–∏—è "üìé –†–µ—Ñ–µ—Ä–µ–Ω—Å–Ω–æ–µ —Ñ–æ—Ç–æ –¥–ª—è –∫–∞—Ä—Ç–∏–Ω–∫–∏" (—Å –ø—Ä–µ–≤—å—é, —Å—Ç–∞—Ç—É—Å–æ–º, –∫–Ω–æ–ø–∫–æ–π —É–¥–∞–ª–µ–Ω–∏—è)
2. **–°–æ–∑–¥–∞—Ç—å –ø–æ—Å—Ç** ‚Äî –ø–µ—Ä–µ–¥ –∫–Ω–æ–ø–∫–æ–π –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ + –≤ —Å–µ–∫—Ü–∏–∏ –ø–µ—Ä–µ–≥–µ–Ω–µ—Ä–∞—Ü–∏–∏
3. **–ê–≤—Ç–æ–ø—É–±–ª–∏–∫–∞—Ü–∏—è** ‚Äî –ø–µ—Ä–µ–¥ "–°–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å —á–µ—Ä–Ω–æ–≤–∏–∫" + –≤ —Å–µ–∫—Ü–∏–∏ —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è —á–µ—Ä–Ω–æ–≤–∏–∫–∞

### –ö–∞–∫ –ø–µ—Ä–µ–¥–∞—ë—Ç—Å—è –≤ API
–ü–∞—Ä–∞–º–µ—Ç—Ä `reference_image_b64` (base64 JPEG) –ø–µ—Ä–µ–¥–∞—ë—Ç—Å—è –≤ `generate_image()`:

**Gemini:** –¥–æ–±–∞–≤–ª—è–µ—Ç—Å—è –∫–∞–∫ `types.Part.from_bytes` –≤ multimodal –∑–∞–ø—Ä–æ—Å –≤–º–µ—Å—Ç–µ —Å —Ç–µ–∫—Å—Ç–æ–≤—ã–º –ø—Ä–æ–º–ø—Ç–æ–º.
**OpenAI:** –ø–µ—Ä–µ–∫–ª—é—á–∞–µ—Ç –≥–µ–Ω–µ—Ä–∞—Ü–∏—é —Å `images.generate()` (dall-e-3) –Ω–∞ `images.edit()` (gpt-image-1) —Å —Ñ–æ—Ç–æ –∫–∞–∫ –≤—Ö–æ–¥–Ω—ã–º –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ–º.

### –°–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å —Å face swap
–†–µ—Ñ–µ—Ä–µ–Ω—Å–Ω–æ–µ —Ñ–æ—Ç–æ –∏ face swap ‚Äî –Ω–µ–∑–∞–≤–∏—Å–∏–º—ã–µ —Ñ–∏—á–∏. –ú–æ–≥—É—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å—Å—è –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ:
- `expert_face_b64` ‚Äî –ª–∏—Ü–æ —ç–∫—Å–ø–µ—Ä—Ç–∞ (–¥–ª—è face swap / inline face)
- `reference_image_b64` ‚Äî —Å—Ç–∏–ª—å/–∫–æ–º–ø–æ–∑–∏—Ü–∏—è/–∞—Ç–º–æ—Å—Ñ–µ—Ä–∞
- –ü—Ä–∏ –Ω–∞–ª–∏—á–∏–∏ –æ–±–æ–∏—Ö ‚Äî OpenAI –ø–æ–ª—É—á–∞–µ—Ç —Å–ø–∏—Å–æ–∫ –∏–∑ 2 –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π –≤ `images.edit()`

### Session state
–•—Ä–∞–Ω–∏—Ç—Å—è –≤ `st.session_state["reference_image_b64"]`. –í—Å–µ –∑–∞–≥—Ä—É–∑—á–∏–∫–∏ –≤–æ –≤—Å–µ—Ö –≤–∫–ª–∞–¥–∫–∞—Ö –ø–∏—à—É—Ç –≤ –æ–¥–∏–Ω –∏ —Ç–æ—Ç –∂–µ –∫–ª—é—á ‚Äî —Ñ–æ—Ç–æ, –∑–∞–≥—Ä—É–∂–µ–Ω–Ω–æ–µ –≤ –æ–¥–Ω–æ–π –≤–∫–ª–∞–¥–∫–µ, –¥–æ—Å—Ç—É–ø–Ω–æ –≤ –¥—Ä—É–≥–∏—Ö.

---

## Dual Auth: AI Studio + Vertex AI

`config.py` —Å–æ–¥–µ—Ä–∂–∏—Ç —Ñ–∞–±—Ä–∏–∫—É `get_gemini_client()` —Å —Ç—Ä–µ–º—è —É—Ä–æ–≤–Ω—è–º–∏ –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç–∞:
1. `api_key_override` (—è–≤–Ω—ã–π –∫–ª—é—á) ‚Üí AI Studio
2. `GOOGLE_PROJECT_ID` + service account ‚Üí Vertex AI
3. `GEMINI_API_KEY` ‚Üí AI Studio

```python
def get_gemini_client(api_key_override=None):
    from google import genai
    if api_key_override:
        return genai.Client(api_key=api_key_override)
    if GOOGLE_PROJECT_ID:
        _setup_vertex_credentials()
        return genai.Client(vertexai=True, project=GOOGLE_PROJECT_ID, location=GOOGLE_LOCATION)
    if GEMINI_API_KEY:
        return genai.Client(api_key=GEMINI_API_KEY)
    raise ValueError("No Gemini credentials found...")
```

–í—Å–µ –º–æ–¥—É–ª–∏ –∏—Å–ø–æ–ª—å–∑—É—é—Ç `get_gemini_client()`: `generate_text.py`, `generate_image.py`, `face_swap.py`.

---

## –†–µ—à—ë–Ω–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã

### 1. Replicate face swap ‚Äî –º–æ–¥–µ–ª—å —É–¥–∞–ª–µ–Ω–∞ (—Ñ–µ–≤—Ä–∞–ª—å 2026)
**–ü—Ä–æ–±–ª–µ–º–∞:** –û—Ä–∏–≥–∏–Ω–∞–ª—å–Ω–∞—è –º–æ–¥–µ–ª—å `xiankgx/face-swap` —É–¥–∞–ª–µ–Ω–∞ —Å Replicate (404).
**–†–µ—à–µ–Ω–∏–µ:** –ó–∞–º–µ–Ω–µ–Ω–∞ –Ω–∞ `codeplugtech/face-swap` —Å —è–≤–Ω—ã–º version hash.
**–í–∞–∂–Ω–æ:** –ë–µ–∑ version hash Replicate SDK –∏—Å–ø–æ–ª—å–∑—É–µ—Ç endpoint `/v1/models/.../predictions` (404). –° hash –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è `/v1/predictions` (—Ä–∞–±–æ—Ç–∞–µ—Ç).
```python
# –ü–†–ê–í–ò–õ–¨–ù–û ‚Äî —Å version hash:
"codeplugtech/face-swap:278a81e7ebb22db98bcba54de985d22cc1abeead2754eb1f2af717247be69b34"

# –ù–ï–ü–†–ê–í–ò–õ–¨–ù–û ‚Äî –±–µ–∑ hash (404):
"codeplugtech/face-swap"
```

### 2. REPLICATE_API_KEY –Ω–µ –±—ã–ª –¥–æ–±–∞–≤–ª–µ–Ω –≤ GitHub Secrets
**–ü—Ä–æ–±–ª–µ–º–∞:** –ö–ª—é—á –æ—Ç—Å—É—Ç—Å—Ç–≤–æ–≤–∞–ª ‚Üí –æ—à–∏–±–∫–∞ "REPLICATE_API_KEY –Ω–µ –∑–∞–¥–∞–Ω".
**–†–µ—à–µ–Ω–∏–µ:** –î–æ–±–∞–≤–ª–µ–Ω –≤ Settings ‚Üí Secrets ‚Üí Actions.

### 3. –ù–µ—Ä–∞–±–æ—á–∏–µ –º–æ–¥–µ–ª–∏ Replicate (–Ω–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å)
- `xiankgx/face-swap` ‚Äî —É–¥–∞–ª–µ–Ω–∞
- `arabyai-replicate/roop_face_swap` ‚Äî —Ç–æ–ª—å–∫–æ –≤–∏–¥–µ–æ, –Ω–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è
- `cdingram/face-swap` (–±–µ–∑ hash) ‚Äî 404
- `easel/advanced-face-swap` ‚Äî 404
- `fofr/face-swap-with-ideogram` ‚Äî 404

### 4. –†–∞—Å—Å–∏–Ω—Ö—Ä–æ–Ω provider.cfg –º–µ–∂–¥—É –ª–æ–∫–∞–ª—å–Ω–æ–π –∫–æ–ø–∏–µ–π –∏ GitHub
**–ü—Ä–æ–±–ª–µ–º–∞:** Streamlit UI –æ–±–Ω–æ–≤–ª—è–µ—Ç —Ñ–∞–π–ª —á–µ—Ä–µ–∑ GitHub API, –∞ –ª–æ–∫–∞–ª—å–Ω–∞—è –∫–æ–ø–∏—è –æ—Å—Ç–∞—ë—Ç—Å—è —Å—Ç–∞—Ä–æ–π.
**–†–µ—à–µ–Ω–∏–µ:** –í—Å–µ–≥–¥–∞ –¥–µ–ª–∞—Ç—å `git pull` –ø–µ—Ä–µ–¥ —Ä–∞–±–æ—Ç–æ–π, –∏–ª–∏ –ø—Ä–æ–≤–µ—Ä—è—Ç—å –∞–∫—Ç—É–∞–ª—å–Ω—ã–π provider.cfg –Ω–∞ GitHub.

### 5. Gemini: —É—Å—Ç–∞—Ä–µ–≤—à–∏–µ –º–æ–¥–µ–ª–∏ (—Ñ–µ–≤—Ä–∞–ª—å 2026)
**–ü—Ä–æ–±–ª–µ–º–∞:** –ú–æ–¥–µ–ª—å `gemini-2.5-flash-preview-04-17` —É–¥–∞–ª–µ–Ω–∞ ‚Üí –æ—à–∏–±–∫–∞ `'ascii' codec can't encode`.
**–†–µ—à–µ–Ω–∏–µ:** –û–±–Ω–æ–≤–ª–µ–Ω—ã –º–æ–¥–µ–ª–∏:
- –¢–µ–∫—Å—Ç: `gemini-2.5-flash-preview-04-17` ‚Üí `gemini-2.5-flash` (GA)
- –ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è/face swap: ‚Üí `gemini-2.5-flash-image` (GA)

### 6. Gemini: API –∫–ª—é—á –∏–∑ Cloud Console vs AI Studio
**–ü—Ä–æ–±–ª–µ–º–∞:** –ö–ª—é—á –∏–∑ Google Cloud Console (Vertex AI) –¥–∞–µ—Ç –æ—à–∏–±–∫—É "API keys are not supported by this API".
**–†–µ—à–µ–Ω–∏–µ:** –î–ª—è AI Studio –Ω—É–∂–µ–Ω –∫–ª—é—á **—Ç–æ–ª—å–∫–æ —Å aistudio.google.com**. –ö–ª—é—á–∏ –∏–∑ Cloud Console ‚Äî —ç—Ç–æ Vertex AI, —Ç—Ä–µ–±—É—é—Ç OAuth2.

### 7. Gemini: –º–æ–¥–µ–ª–∏ —Å OAuth2 (–Ω–µ —Ä–∞–±–æ—Ç–∞—é—Ç —Å API –∫–ª—é—á–∞–º–∏)
**–ü—Ä–æ–±–ª–µ–º–∞:** `gemini-3.1-flash-image-preview` (Nano Banana 2) –∏ `gemini-2.5-flash-preview-05-20` —Ç—Ä–µ–±—É—é—Ç OAuth2.
**–†–µ—à–µ–Ω–∏–µ:** –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å GA-–º–æ–¥–µ–ª–∏: `gemini-2.5-flash` (—Ç–µ–∫—Å—Ç), `gemini-2.5-flash-image` (–∫–∞—Ä—Ç–∏–Ω–∫–∏).

### 8. Gemini: –∫–≤–æ—Ç–∞ free tier = 0 –¥–ª—è image generation
**–ü—Ä–æ–±–ª–µ–º–∞:** –ë–µ—Å–ø–ª–∞—Ç–Ω—ã–π –∫–ª—é—á AI Studio –∏–º–µ–µ—Ç –ª–∏–º–∏—Ç 0 –∑–∞–ø—Ä–æ—Å–æ–≤ –¥–ª—è `gemini-2.5-flash-preview-image` ‚Üí –æ—à–∏–±–∫–∞ 429 RESOURCE_EXHAUSTED.
**–†–µ—à–µ–Ω–∏–µ:** Inline face generation (1 –≤—ã–∑–æ–≤ –≤–º–µ—Å—Ç–æ 2) —Å–Ω–∏–∂–∞–µ—Ç —Ä–∞—Å—Ö–æ–¥ –∫–≤–æ—Ç—ã. –ù–æ –¥–ª—è —Å—Ç–∞–±–∏–ª—å–Ω–æ–π —Ä–∞–±–æ—Ç—ã –Ω—É–∂–Ω–æ **–≤–∫–ª—é—á–∏—Ç—å –±–∏–ª–ª–∏–Ω–≥** –≤ AI Studio.

### 9. VK API: `photos.getWallUploadServer` –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç —Å group token (–º–∞—Ä—Ç 2026)
**–ü—Ä–æ–±–ª–µ–º–∞:** –¢–æ–∫–µ–Ω —Å–æ–æ–±—â–µ—Å—Ç–≤–∞ (community/group token) –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –æ—à–∏–±–∫—É "Group authorization failed: method is unavailable with group auth" –ø—Ä–∏ –≤—ã–∑–æ–≤–µ `photos.getWallUploadServer`.
**–†–µ—à–µ–Ω–∏–µ:** –î–æ–±–∞–≤–ª–µ–Ω –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π fallback: –µ—Å–ª–∏ `getWallUploadServer` –Ω–µ –¥–æ—Å—Ç—É–ø–µ–Ω, –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è `photos.getMessagesUploadServer` + `photos.saveMessagesPhoto`, –∫–æ—Ç–æ—Ä—ã–µ —Ä–∞–±–æ—Ç–∞—é—Ç —Å –æ–±–æ–∏–º–∏ —Ç–∏–ø–∞–º–∏ —Ç–æ–∫–µ–Ω–æ–≤.
**–í–∞–∂–Ω–æ:** `wall.post` —Ä–∞–±–æ—Ç–∞–µ—Ç —Å group token. –ü—Ä–æ–±–ª–µ–º–∞ –±—ã–ª–∞ —Ç–æ–ª—å–∫–æ –≤ –º–µ—Ç–æ–¥–µ –∑–∞–≥—Ä—É–∑–∫–∏ —Ñ–æ—Ç–æ.

### 10. –ë–∏–±–ª–∏–æ—Ç–µ–∫–∞ –∫–∞—Ä—Ç–∏–Ω–æ–∫: –ø–æ—Ç–µ—Ä—è —Ñ–∞–π–ª–æ–≤ –Ω–∞ Streamlit Cloud (—Ñ–µ–≤—Ä–∞–ª—å 2026)
**–ü—Ä–æ–±–ª–µ–º–∞:** Streamlit Cloud –∏—Å–ø–æ–ª—å–∑—É–µ—Ç —ç—Ñ–µ–º–µ—Ä–Ω—É—é —Ñ–∞–π–ª–æ–≤—É—é —Å–∏—Å—Ç–µ–º—É ‚Äî –ø–æ—Å–ª–µ –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∏ —Å—Ç—Ä–∞–Ω–∏—Ü—ã –≤—Å–µ –∑–∞–≥—Ä—É–∂–µ–Ω–Ω—ã–µ –∫–∞—Ä—Ç–∏–Ω–∫–∏ –ø—Ä–æ–ø–∞–¥–∞–ª–∏.
**–†–µ—à–µ–Ω–∏–µ:** –î–æ–±–∞–≤–ª–µ–Ω–∞ —Ñ—É–Ω–∫—Ü–∏—è `_ensure_image_library_from_github()` ‚Äî –ø—Ä–∏ —Å—Ç–∞—Ä—Ç–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è –ø—Ä–æ–≤–µ—Ä—è–µ—Ç –Ω–∞–ª–∏—á–∏–µ –ª–æ–∫–∞–ª—å–Ω–æ–≥–æ `image_library.json`, –µ—Å–ª–∏ –Ω–µ—Ç ‚Äî –∑–∞–≥—Ä—É–∂–∞–µ—Ç –∏–Ω–¥–µ–∫—Å –∏ –≤—Å–µ –∫–∞—Ä—Ç–∏–Ω–∫–∏ –∏–∑ GitHub.
**–í–∞–∂–Ω–æ:** –¢—Ä–µ–±—É–µ—Ç—Å—è `GITHUB_TOKEN` –≤ Streamlit Secrets. –ë–µ–∑ –Ω–µ–≥–æ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç –∏ –∫–∞—Ä—Ç–∏–Ω–∫–∏ —Ç–µ—Ä—è—é—Ç—Å—è –ø—Ä–∏ –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–µ.

---

## –¢–µ–∫—É—â–∞—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è (provider.cfg –Ω–∞ GitHub)
```
TEXT_PROVIDER=gemini
IMAGE_PROVIDER=openai
AUTOPUBLISH_ENABLED=true
FACE_SWAP_PROVIDER=
IMAGE_SOURCE=library
PUBLISH_TARGETS=telegram,vk
TELEGRAM_FOOTER=
VK_FOOTER=
MAX_FOOTER=
PINTEREST_LINK=
```

–ü—Ä–∏ —ç—Ç–æ–π –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏:
- –¢–µ–∫—Å—Ç –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç—Å—è —á–µ—Ä–µ–∑ **Gemini** (`gemini-2.5-flash`)
- –ö–∞—Ä—Ç–∏–Ω–∫–∞ –±–µ—Ä—ë—Ç—Å—è –∏–∑ **–±–∏–±–ª–∏–æ—Ç–µ–∫–∏** (–ø–µ—Ä–µ–∫–ª—é—á–∞–µ—Ç—Å—è –Ω–∞ AI-–≥–µ–Ω–µ—Ä–∞—Ü–∏—é –≤ UI)
- Face swap **–æ—Ç–∫–ª—é—á—ë–Ω**
- –ü—É–±–ª–∏–∫–∞—Ü–∏—è –≤ **Telegram** –∏ **–í–ö–æ–Ω—Ç–∞–∫—Ç–µ** (–º–æ–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å max, pinterest —á–µ—Ä–µ–∑ UI)
- –§—É—Ç–µ—Ä—ã –Ω–µ –∑–∞–¥–∞–Ω—ã (–ø–æ—Å—Ç—ã –ø—É–±–ª–∏–∫—É—é—Ç—Å—è –±–µ–∑ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã—Ö —Å—Å—ã–ª–æ–∫)

---

## –ö–æ–º–±–∏–Ω–∞—Ü–∏–∏ –Ω–∞—Å—Ç—Ä–æ–µ–∫ –≤ Streamlit UI

### IMAGE_SOURCE = generate (AI-–≥–µ–Ω–µ—Ä–∞—Ü–∏—è)

| IMAGE_PROVIDER | FACE_SWAP_PROVIDER | –ß—Ç–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç |
|----------------|-------------------|----------------|
| `gemini` | `gemini` | 1 –≤—ã–∑–æ–≤: Gemini –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç –∫–∞—Ä—Ç–∏–Ω–∫—É —Å –ª–∏—Ü–æ–º (inline) |
| `openai` | `openai` | 2 –≤—ã–∑–æ–≤–∞: OpenAI –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç + OpenAI face swap (–æ—Ç–¥–µ–ª—å–Ω—ã–π —à–∞–≥) |
| `gemini` | `openai` | 2 –≤—ã–∑–æ–≤–∞: Gemini –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç + OpenAI face swap |
| `openai` | `gemini` | 2 –≤—ã–∑–æ–≤–∞: OpenAI –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç + Gemini face swap |
| `gemini` | `replicate` | 2 –≤—ã–∑–æ–≤–∞: Gemini –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç + Replicate –º–µ–Ω—è–µ—Ç –ª–∏—Ü–æ |
| `openai` | `replicate` | 2 –≤—ã–∑–æ–≤–∞: OpenAI –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç + Replicate –º–µ–Ω—è–µ—Ç –ª–∏—Ü–æ |
| –ª—é–±–æ–π | (–ø—É—Å—Ç–æ) | –ö–∞—Ä—Ç–∏–Ω–∫–∞ –±–µ–∑ –ª–∏—Ü–∞ —ç–∫—Å–ø–µ—Ä—Ç–∞ |

**–ü—Ä–∏–º–µ—á–∞–Ω–∏–µ:** Inline face (1 –≤—ã–∑–æ–≤) —Ä–∞–±–æ—Ç–∞–µ—Ç —Ç–æ–ª—å–∫–æ –ø—Ä–∏ `gemini`+`gemini`. –í—Å–µ –æ—Å—Ç–∞–ª—å–Ω—ã–µ –∫–æ–º–±–∏–Ω–∞—Ü–∏–∏ –∏—Å–ø–æ–ª—å–∑—É—é—Ç 2 –≤—ã–∑–æ–≤–∞.
–ü—Ä–∏ –Ω–∞–ª–∏—á–∏–∏ **—Ä–µ—Ñ–µ—Ä–µ–Ω—Å–Ω–æ–≥–æ —Ñ–æ—Ç–æ** ‚Äî –æ–Ω–æ –ø–µ—Ä–µ–¥–∞—ë—Ç—Å—è –≤ –ø–µ—Ä–≤—ã–π –≤—ã–∑–æ–≤ (–≥–µ–Ω–µ—Ä–∞—Ü–∏—è) –Ω–µ–∑–∞–≤–∏—Å–∏–º–æ –æ—Ç –ø—Ä–æ–≤–∞–π–¥–µ—Ä–∞.

### IMAGE_SOURCE = library (–ë–∏–±–ª–∏–æ—Ç–µ–∫–∞)
- –ö–∞—Ä—Ç–∏–Ω–∫–∞ –±–µ—Ä—ë—Ç—Å—è –∏–∑ –±–∏–±–ª–∏–æ—Ç–µ–∫–∏ (circular queue)
- IMAGE_PROVIDER –∏ FACE_SWAP_PROVIDER –∏–≥–Ω–æ—Ä–∏—Ä—É—é—Ç—Å—è –∏ —Å–∫—Ä—ã—Ç—ã –≤ UI
- Face swap –Ω–µ –ø—Ä–∏–º–µ–Ω—è–µ—Ç—Å—è

---

## –í–∞–∂–Ω—ã–µ —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –¥–µ—Ç–∞–ª–∏

- **–ú—É–ª—å—Ç–∏–ø–ª–∞—Ç—Ñ–æ—Ä–º–∞:** –û—à–∏–±–∫–∞ –ø—É–±–ª–∏–∫–∞—Ü–∏–∏ –Ω–∞ –æ–¥–Ω–æ–π –ø–ª–∞—Ç—Ñ–æ—Ä–º–µ –Ω–µ –±–ª–æ–∫–∏—Ä—É–µ—Ç –¥—Ä—É–≥–∏–µ
- **Telegram:** Caption <= 1024 —Å–∏–º–≤–æ–ª–æ–≤ ‚Üí –µ—Å–ª–∏ –¥–ª–∏–Ω–Ω–µ–µ, –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è —Ñ–æ—Ç–æ + –æ—Ç–¥–µ–ª—å–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ
- **VK/Max/Pinterest:** HTML-—Ç–µ–≥–∏ —É–¥–∞–ª—è—é—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ (`_strip_html()`)
- **Base64 –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è:** –•—Ä–∞–Ω—è—Ç—Å—è –≤ JSON, JPEG quality=85
- **Face swap fallback:** –ï—Å–ª–∏ –æ—à–∏–±–∫–∞ ‚Äî –ø—É–±–ª–∏–∫—É–µ—Ç—Å—è –±–µ–∑ –∑–∞–º–µ–Ω—ã –ª–∏—Ü–∞ (–Ω–µ –ø–∞–¥–∞–µ—Ç)
- **GitHub –∫–∞–∫ –ë–î:** –í—Å–µ –¥–∞–Ω–Ω—ã–µ –∫–æ–º–º–∏—Ç—è—Ç—Å—è –≤ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π
- **–ü—Ä–æ–º–ø—Ç—ã –Ω–∞ —Ä—É—Å—Å–∫–æ–º**, –∫–æ–¥ –∏ API-–≤—ã–∑–æ–≤—ã –Ω–∞ –∞–Ω–≥–ª–∏–π—Å–∫–æ–º
- **expert_face.json** (~875KB) ‚Äî –æ—Ç—Å–ª–µ–∂–∏–≤–∞–µ—Ç—Å—è –≤ git
- **SDK:** –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è `google-genai` (–Ω–æ–≤—ã–π SDK), –ù–ï `google.generativeai` (—Å—Ç–∞—Ä—ã–π)
- **Streamlit Cloud:** –°–µ–∫—Ä–µ—Ç—ã –±—Ä–∏–¥–∂–∞—Ç—Å—è –≤ `os.environ` —á–µ—Ä–µ–∑ `_SECRET_KEYS` –≤ `app.py`
- **Streamlit Cloud: —ç—Ñ–µ–º–µ—Ä–Ω–∞—è FS** ‚Äî –ø—Ä–∏ –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–µ –ª–æ–∫–∞–ª—å–Ω—ã–µ —Ñ–∞–π–ª—ã —Ç–µ—Ä—è—é—Ç—Å—è; –¥–∞–Ω–Ω—ã–µ —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è —á–µ—Ä–µ–∑ GitHub API –∏ –≤–æ—Å—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞—é—Ç—Å—è –ø—Ä–∏ —Å—Ç–∞—Ä—Ç–µ (`expert_face.json`, `image_library.json`, `image_library/*.json`)
- **–ë–∏–±–ª–∏–æ—Ç–µ–∫–∞ –∫–∞—Ä—Ç–∏–Ω–æ–∫:** split storage (–∏–Ω–¥–µ–∫—Å + –æ—Ç–¥–µ–ª—å–Ω—ã–µ —Ñ–∞–π–ª—ã) –¥–ª—è –æ–±—Ö–æ–¥–∞ –ª–∏–º–∏—Ç–∞ 100MB GitHub

---

## Streamlit UI ‚Äî 6 –≤–∫–ª–∞–¥–æ–∫

| # | –í–∫–ª–∞–¥–∫–∞ | –°–æ–¥–µ—Ä–∂–∏–º–æ–µ |
|---|---------|------------|
| 1 | ‚úèÔ∏è –ü—Ä–æ–º–ø—Ç—ã | System prompt, image prompt, —Ä–µ—Ñ–µ—Ä–µ–Ω—Å–Ω–æ–µ —Ñ–æ—Ç–æ, –∫–æ–Ω—Ç–µ–∫—Å—Ç–Ω—ã–π –¥–æ–∫—É–º–µ–Ω—Ç |
| 2 | üìã –ò–¥–µ–∏ | –ü—É–ª –∏–¥–µ–π, –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ/—É–¥–∞–ª–µ–Ω–∏–µ, —Å—Ç–∞—Ç—É—Å used/unused |
| 3 | üöÄ –°–æ–∑–¥–∞—Ç—å –ø–æ—Å—Ç | –ì–µ–Ω–µ—Ä–∞—Ü–∏—è —Ç–µ–∫—Å—Ç–∞ + –∫–∞—Ä—Ç–∏–Ω–∫–∏, –ø—Ä–µ–≤—å—é, –ø—É–±–ª–∏–∫–∞—Ü–∏—è |
| 4 | ‚è∞ –ê–≤—Ç–æ–ø—É–±–ª–∏–∫–∞—Ü–∏—è | –ß–µ—Ä–Ω–æ–≤–∏–∫ –∏–∑ GitHub, —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ, –ø—É–±–ª–∏–∫–∞—Ü–∏—è, –≥–µ–Ω–µ—Ä–∞—Ü–∏—è –Ω–æ–≤–æ–≥–æ |
| 5 | üìä –ò—Å—Ç–æ—Ä–∏—è | –ê—Ä—Ö–∏–≤ –æ–ø—É–±–ª–∏–∫–æ–≤–∞–Ω–Ω—ã—Ö –ø–æ—Å—Ç–æ–≤ |
| 6 | üñºÔ∏è –ë–∏–±–ª–∏–æ—Ç–µ–∫–∞ | –ó–∞–≥—Ä—É–∑–∫–∞/—É–¥–∞–ª–µ–Ω–∏–µ –∫–∞—Ä—Ç–∏–Ω–æ–∫, –≥–∞–ª–µ—Ä–µ—è, —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –æ—á–µ—Ä–µ–¥—å—é |

**Sidebar:**
- –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –ø—Ä–æ–≤–∞–π–¥–µ—Ä–æ–≤ (TEXT_PROVIDER, IMAGE_PROVIDER, FACE_SWAP_PROVIDER)
- –ü–µ—Ä–µ–∫–ª—é—á–∞—Ç–µ–ª—å IMAGE_SOURCE (AI-–≥–µ–Ω–µ—Ä–∞—Ü–∏—è / –ë–∏–±–ª–∏–æ—Ç–µ–∫–∞)
- –ü–ª–∞—Ç—Ñ–æ—Ä–º—ã –ø—É–±–ª–∏–∫–∞—Ü–∏–∏ (–º—É–ª—å—Ç–∏—Å–µ–ª–µ–∫—Ç: Telegram, VK, Max, Pinterest)
- API-–∫–ª—é—á–∏ (—É—Å–ª–æ–≤–Ω–æ –æ—Ç–æ–±—Ä–∞–∂–∞—é—Ç—Å—è –ø–æ –≤—ã–±—Ä–∞–Ω–Ω—ã–º –ø–ª–∞—Ç—Ñ–æ—Ä–º–∞–º)
- –§–æ—Ç–æ —ç–∫—Å–ø–µ—Ä—Ç–∞ –¥–ª—è face swap
- –ö–Ω–æ–ø–∫–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –Ω–∞—Å—Ç—Ä–æ–µ–∫ (–ª–æ–∫–∞–ª—å–Ω–æ + GitHub)

---

## –†–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π
`alexandermalevich85-commits/telegram-autoposter`

## –°–µ–∫—Ä–µ—Ç—ã GitHub Actions / Streamlit Cloud

### –û–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ
- `GITHUB_TOKEN` ‚Äî –¥–ª—è —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö —á–µ—Ä–µ–∑ UI (–±–∏–±–ª–∏–æ—Ç–µ–∫–∞, —á–µ—Ä–Ω–æ–≤–∏–∫–∏, –Ω–∞—Å—Ç—Ä–æ–π–∫–∏)

### –ü—Ä–æ–≤–∞–π–¥–µ—Ä—ã AI (–º–∏–Ω–∏–º—É–º –æ–¥–∏–Ω –¥–ª—è —Ç–µ–∫—Å—Ç–∞)
- `CLAUDE_API_KEY`
- `GEMINI_API_KEY`
- `OPENAI_API_KEY`
- `REPLICATE_API_KEY` (—Ç–æ–ª—å–∫–æ –¥–ª—è face swap —á–µ—Ä–µ–∑ Replicate)

### –ü–ª–∞—Ç—Ñ–æ—Ä–º—ã –ø—É–±–ª–∏–∫–∞—Ü–∏–∏
- `TELEGRAM_BOT_TOKEN` + `TELEGRAM_CHANNEL_ID`
- `VK_ACCESS_TOKEN` + `VK_GROUP_ID` (community-—Ç–æ–∫–µ–Ω —Å –ø—Ä–∞–≤–∞–º–∏ –Ω–∞ –ø—É–±–ª–∏–∫–∞—Ü–∏—é)
- `MAX_BOT_TOKEN` + `MAX_CHAT_ID` (—Ç–æ–∫–µ–Ω –±–æ—Ç–∞ Max, ID –∫–∞–Ω–∞–ª–∞/—á–∞—Ç–∞)
- `PINTEREST_ACCESS_TOKEN` + `PINTEREST_BOARD_ID` (OAuth2 —Ç–æ–∫–µ–Ω, ID –¥–æ—Å–∫–∏)

### –û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–µ (Vertex AI)
- `GOOGLE_PROJECT_ID`
- `GOOGLE_LOCATION` (default: us-central1)
- `GOOGLE_SERVICE_ACCOUNT_JSON`
